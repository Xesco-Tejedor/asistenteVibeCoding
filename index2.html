<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title> Explorador de Legados Art铆sticos: 驴Y si...?锔 (DEMO)</title>
    <style>
        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            margin: 0;
            padding: 0;
            background-color: #f0f2f5;
            color: #333;
            line-height: 1.6;
        }
        header {
            background-color: #2c3e50;
            color: white;
            padding: 1.5em 0;
            text-align: center;
            box-shadow: 0 4px 8px rgba(0, 0, 0, 0.1);
        }
        h1 {
            margin: 0;
            font-size: 2.8em;
            letter-spacing: 1px;
        }
        .container {
            width: 85%;
            max-width: 1200px;
            margin: 30px auto;
            background-color: white;
            padding: 30px;
            border-radius: 10px;
            box-shadow: 0 4px 15px rgba(0, 0, 0, 0.1);
        }
        .intro-section {
            text-align: center;
            margin-bottom: 40px;
            font-size: 1.1em;
            color: #555;
        }
        .controls-section {
            display: flex;
            justify-content: center;
            align-items: center;
            gap: 20px;
            margin-bottom: 30px;
            flex-wrap: wrap;
        }
        select {
            padding: 10px 15px;
            font-size: 1em;
            border: 1px solid #ccc;
            border-radius: 5px;
            background-color: white;
            cursor: pointer;
        }
        button {
            padding: 10px 20px;
            font-size: 1em;
            background-color: #3498db;
            color: white;
            border: none;
            border-radius: 5px;
            cursor: pointer;
            transition: background-color 0.3s ease;
        }
        button:hover {
            background-color: #2980b9;
        }
        .artwork-display {
            background-color: #ecf0f1;
            padding: 25px;
            border-radius: 8px;
            text-align: center;
            min-height: 300px;
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
        }
        #artworkImage {
            max-width: 100%;
            max-height: 350px;
            border-radius: 8px;
            box-shadow: 0 2px 10px rgba(0, 0, 0, 0.1);
            margin-bottom: 20px;
            display: none;
        }
        #artworkTitle {
            font-size: 2em;
            color: #2c3e50;
            margin-top: 10px;
            margin-bottom: 5px;
        }
        #artworkDescription {
            font-size: 1.1em;
            color: #666;
            max-width: 700px;
        }
        .wikipedia-simulation {
            margin-top: 20px;
            padding: 15px;
            background-color: #f9f9f9;
            border: 1px solid #ddd;
            border-radius: 5px;
            font-style: italic;
            color: #777;
        }
        footer {
            text-align: center;
            padding: 20px;
            background-color: #2c3e50;
            color: white;
            margin-top: 40px;
            font-size: 0.9em;
        }
        #downloadHistoryBtn {
            margin-top: 20px;
            background-color: #27ae60;
        }
        #downloadHistoryBtn:hover {
            background-color: #229954;
        }
        #loadingSpinner {
            border: 4px solid rgba(0, 0, 0, 0.1);
            border-left-color: #3498db;
            border-radius: 50%;
            width: 30px;
            height: 30px;
            animation: spin 1s linear infinite;
            display: none;
            margin-top: 20px;
        }
        @keyframes spin {
            to {
                transform: rotate(360deg);
            }
        }
        /* Estilos para el aviso de demo */
        .demo-warning {
            background-color: #ffda00; /* Amarillo vibrante */
            color: #333;
            padding: 15px;
            text-align: center;
            font-weight: bold;
            font-size: 1.1em;
            border-bottom: 3px solid #ccab00;
        }
        .demo-warning p {
            margin: 0;
        }
    </style>
</head>
<body>
    <div class="demo-warning">
        <p><strong>AVISO: Esta es una versi贸n DEMO. Tu clave de API de OpenAI est谩 expuesta en el c贸digo.</strong></p>
        <p>Esto NO es seguro para uso en producci贸n. sala bajo tu propio riesgo y con una clave de API con l铆mites de gasto.</p>
    </div>

    <header>
        <h1> Explorador de Legados Art铆sticos: 驴Y si...?锔</h1>
    </header>

    <div class="container">
        <section class="intro-section">
            <p>隆Bienvenido al <strong>Explorador de Legados Art铆sticos: 驴Y si...?锔</strong>! Esta aplicaci贸n web te invita a un viaje fascinante a trav茅s de la imaginaci贸n, visualizando las posibles creaciones futuras de artistas ic贸nicos si su viaje creativo no se hubiera interrumpido o si hubiera tomado otros derroteros.</p>
            <p>Selecciona un artista y descubre una obra hipot茅tica generada por la IA.</p>
        </section>

        <section class="controls-section">
            <label for="artistSelect">Selecciona un artista:</label>
            <select id="artistSelect"></select>
            <button onclick="exploreArtist()">Explorar Legado</button>
            <button id="downloadHistoryBtn" onclick="downloadSessionHistory()">Descargar Historial de Sesi贸n</button>
        </section>

        <section class="artwork-display">
            <div id="loadingSpinner"></div>
            <img id="artworkImage" alt="Obra de arte generada por IA">
            <h2 id="artworkTitle"></h2>
            <p id="artworkDescription"></p>
            <div id="wikipediaSimulation" class="wikipedia-simulation">
                </div>
            <p id="initialPrompt">Selecciona un artista para comenzar tu exploraci贸n.</p>
        </section>
    </div>

    <footer>
        <p>&copy; 2025 Explorador de Legados Art铆sticos. Proyecto de Vibe Coding con IA.</p>
        <p>Inspirado por el legado de los grandes maestros.</p>
    </footer>

    <script>
        // *** TU CLAVE DE API DE OPENAI (隆NO USAR EN PRODUCCIN!) ***
        // Reemplaza 'TU_CLAVE_DE_API_OPENAI_AQUI' con tu clave real.
        // Puedes obtener una en https://platform.openai.com/account/api-keys
        const OPENAI_API_KEY = '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'; 

        // Base de datos interna de artistas y obras hipot茅ticas
        const artistsData = [
            {
                id: 'van_gogh',
                name: 'Vincent van Gogh',
                wikipediaSim: 'Consultando Wikipedia para Vincent van Gogh: Conocido por su uso vibrante del color y pinceladas emotivas. Obras como "La noche estrellada" y "Los girasoles" son emblem谩ticas.',
                hypotheticalWorks: [
                    {
                        title: 'Campos de Tulipanes al Atardecer',
                        description: 'Una composici贸n expansiva que combina la paleta intensa de los campos de tulipanes holandeses con el turbulento cielo vespertino. Las pinceladas gruesas capturan el movimiento del viento y la explosi贸n de color.',
                        prompt: 'A painting in the distinctive style of Vincent van Gogh: Vibrant tulip fields at sunset, with swirling, thick brushstrokes and a turbulent sky, capturing movement and an explosion of color. Post-impressionism, expressive, impasto.'
                    },
                    {
                        title: 'Retrato de un Viajero Existencial',
                        description: 'Un autorretrato con una figura solitaria en un paisaje desolado, capturando la introspecci贸n y la melancol铆a que a menudo se encuentran en sus obras m谩s tard铆as, pero con una esperanza latente en los colores del amanecer.',
                        prompt: 'A self-portrait in the distinctive style of Vincent van Gogh: A solitary figure in a desolate landscape, expressing deep introspection and melancholy, illuminated by a hopeful dawn. Post-impressionism, vibrant colors, emotional intensity.'
                    }
                ]
            },
            {
                id: 'leonardo_da_vinci',
                name: 'Leonardo da Vinci',
                wikipediaSim: 'Consultando Wikipedia para Leonardo da Vinci: Pol铆mata del Renacimiento, artista, cient铆fico, inventor. Famoso por "La Gioconda" y "La ltima Cena".',
                hypotheticalWorks: [
                    {
                        title: 'Estudio de la Microgravedad Humana',
                        description: 'Un intrincado dibujo anat贸mico que explora el cuerpo humano en un entorno de gravedad cero, combinando su precisi贸n cient铆fica con la visi贸n futurista de la exploraci贸n espacial.',
                        prompt: 'An intricate anatomical drawing and schematic in the style of Leonardo da Vinci: Human body in a zero-gravity environment, combining scientific precision with a futuristic vision of space exploration. Renaissance drawing style, highly detailed, cross-sections.'
                    },
                    {
                        title: 'M谩quina Voladora Acu谩tica',
                        description: 'Un dise帽o detallado para un ingenioso dispositivo que permite la exploraci贸n tanto a茅rea como subacu谩tica, con bocetos de mecanismos de propulsi贸n y estabilizaci贸n, revelando su insaciable curiosidad.',
                        prompt: 'A detailed design and schematic drawing in the style of Leonardo da Vinci: An ingenious device for both aerial and underwater exploration, with intricate sketches of propulsion and stabilization mechanisms. Renaissance era blueprints, scientific notation, detailed cross-sections.'
                    }
                ]
            },
            {
                id: 'frida_kahlo',
                name: 'Frida Kahlo',
                wikipediaSim: 'Consultando Wikipedia para Frida Kahlo: Pintora mexicana conocida por sus autorretratos y obras que exploran la identidad, el dolor y la muerte. Influenciada por la cultura ind铆gena mexicana y el surrealismo.',
                hypotheticalWorks: [
                    {
                        title: 'El Jard铆n del Alma Ind贸mita',
                        description: 'Un autorretrato simb贸lico en un jard铆n exuberante, donde flora y fauna m铆sticas representan sus emociones y experiencias. Colores intensos y elementos on铆ricos son prominentes.',
                        prompt: 'A symbolic self-portrait in the distinctive style of Frida Kahlo: An exuberant garden with mystical Mexican flora and fauna representing her emotions and experiences. Intense, vibrant colors, magical realism, surrealism, strong emotional impact.'
                    },
                    {
                        title: 'Mi Conexi贸n con el Cosmos',
                        description: 'Una obra que trasciende la autorreferencia para explorar su relaci贸n con el universo y la naturaleza, con elementos c贸smicos fusionados con s铆mbolos tradicionales mexicanos y una profunda introspecci贸n.',
                        prompt: 'An artwork in the distinctive style of Frida Kahlo: Exploring her connection with the universe and nature, cosmic elements fused with traditional Mexican symbols and deep introspection. Vibrant, folkloric, symbolic, surreal.'
                    }
                ]
            }
        ];

        let sessionHistory = []; // Almacena el historial de obras exploradas

        // Funci贸n para poblar el selector de artistas al cargar la p谩gina
        document.addEventListener('DOMContentLoaded', () => {
            const artistSelect = document.getElementById('artistSelect');
            artistsData.forEach(artist => {
                const option = document.createElement('option');
                option.value = artist.id;
                option.textContent = artist.name;
                artistSelect.appendChild(option);
            });

            // Cargar historial de sesi贸n si existe en localStorage
            const storedHistory = localStorage.getItem('artExplorerHistory');
            if (storedHistory) {
                sessionHistory = JSON.parse(storedHistory);
            }
        });

        async function exploreArtist() {
            const artistSelect = document.getElementById('artistSelect');
            const selectedArtistId = artistSelect.value;
            const artist = artistsData.find(a => a.id === selectedArtistId);

            const artworkImage = document.getElementById('artworkImage');
            const artworkTitle = document.getElementById('artworkTitle');
            const artworkDescription = document.getElementById('artworkDescription');
            const wikipediaSimulationDiv = document.getElementById('wikipediaSimulation');
            const initialPrompt = document.getElementById('initialPrompt');
            const loadingSpinner = document.getElementById('loadingSpinner');

            if (artist) {
                initialPrompt.style.display = 'none';
                artworkImage.style.display = 'none'; // Ocultar imagen anterior

                // Mostrar spinner y mensajes de carga
                loadingSpinner.style.display = 'block';
                artworkTitle.textContent = 'Generando obra de arte...';
                artworkDescription.textContent = 'Por favor, espera unos segundos. La IA est谩 creando tu visi贸n.';
                wikipediaSimulationDiv.textContent = 'Consultando Wikipedia...';


                await new Promise(resolve => setTimeout(resolve, 1500)); // Simular retraso de Wikipedia

                wikipediaSimulationDiv.textContent = artist.wikipediaSim;

                const randomIndex = Math.floor(Math.random() * artist.hypotheticalWorks.length);
                const hypotheticalWork = artist.hypotheticalWorks[randomIndex];

                // Usar el prompt expl铆cito si est谩 definido en hypotheticalWorks, de lo contrario, construirlo.
                const promptForAI = hypotheticalWork.prompt || `${hypotheticalWork.description} in the distinct style of ${artist.name}.`;

                console.log("Prompt enviado a la IA:", promptForAI); 

                try {
                    // --- LLAMADA DIRECTA A LA API DE OPENAI DESDE EL FRONTEND (隆RIESGO DE SEGURIDAD!) ---
                    const response = await fetch('https://api.openai.com/v1/images/generations', {
                        method: 'POST',
                        headers: {
                            'Content-Type': 'application/json',
                            'Authorization': `Bearer ${OPENAI_API_KEY}` // 隆Tu clave de API aqu铆!
                        },
                        body: JSON.stringify({
                            model: "dall-e-3",
                            prompt: promptForAI,
                            n: 1,
                            size: "1024x1024" // Puedes hacer esto configurable si lo deseas
                        })
                    });

                    if (!response.ok) {
                        const errorData = await response.json().catch(() => ({ message: response.statusText }));
                        throw new Error(`Error en la API de OpenAI (${response.status}): ${errorData.message || response.statusText}. C贸digo: ${errorData.code || 'N/A'}`);
                    }

                    const data = await response.json();
                    const generatedImageUrl = data.data[0].url; // DALL-E 3 devuelve la URL en data[0].url

                    artworkImage.src = generatedImageUrl;
                    artworkImage.alt = hypotheticalWork.title;
                    artworkImage.style.display = 'block'; 
                    artworkTitle.textContent = hypotheticalWork.title; 
                    artworkDescription.textContent = hypotheticalWork.description; 

                    // A帽adir al historial de sesi贸n
                    sessionHistory.push({
                        artist: artist.name,
                        artwork: hypotheticalWork.title,
                        generatedImageUrl: generatedImageUrl, 
                        timestamp: new Date().toLocaleString()
                    });
                    localStorage.setItem('artExplorerHistory', JSON.stringify(sessionHistory));

                } catch (error) {
                    console.error("Error al generar la obra de arte:", error);
                    artworkTitle.textContent = 'Error al generar la obra.';
                    artworkDescription.textContent = `Hubo un problema al contactar con la IA. Mensaje: "${error.message}". Revisa tu clave de API y los l铆mites de tu cuenta de OpenAI.`;
                    artworkImage.style.display = 'none';
                    wikipediaSimulationDiv.textContent = 'Ocurri贸 un error en la generaci贸n de imagen.';
                } finally {
                    loadingSpinner.style.display = 'none'; // Ocultar spinner al finalizar
                }

            } else {
                artworkTitle.textContent = 'Artista no encontrado.';
                artworkDescription.textContent = '';
                artworkImage.style.display = 'none';
                wikipediaSimulationDiv.textContent = '';
                initialPrompt.style.display = 'block';
                loadingSpinner.style.display = 'none';
            }
        }

        function downloadSessionHistory() {
            if (sessionHistory.length === 0) {
                alert('No hay historial de sesi贸n para descargar a煤n. 隆Empieza a explorar!');
                return;
            }

            const historyText = sessionHistory.map(entry =>
                `Artista: ${entry.artist}\nObra: ${entry.artwork}\nFecha/Hora: ${entry.timestamp}\nURL Imagen: ${entry.generatedImageUrl || 'N/A'}\n---`
            ).join('\n');

            const blob = new Blob([historyText], { type: 'text/plain' });
            const url = URL.createObjectURL(blob);
            const a = document.createElement('a');
            a.href = url;
            a.download = 'historial_explorador_legados.txt';
            document.body.appendChild(a);
            a.click();
            document.body.removeChild(a);
            URL.revokeObjectURL(url); 
        }
    </script>
</body>
</html>
